import{r as i,j as e}from"./index-m4iuzO1c.js";import{P as x,S as h}from"./ScrollToTopButton-4tOUPZrH.js";const y=20;async function g(c=0){const a=await fetch(`https://pokeapi.co/api/v2/pokemon?offset=${c}&limit=${y}`);if(!a.ok)throw new Error("Failed to fetch Pokemon list");const o=(await a.json()).results.map(async d=>{const s=await fetch(`${d.url}`);if(!s.ok)throw new Error("Failed to fetch pokemon detail");const r=await s.json();return{id:r.id,name:r.name,image:r.sprites.front_shiny||r.sprites.front_default||"",types:r.types.map(t=>t.type.name),stats:r.stats.slice(0,4).map(t=>({name:t.stat.name,base:t.base_stat}))}});return await Promise.all(o)}function w(){async function c(n){const m=await fetch(`https://pokeapi.co/api/v2/pokemon/${n.toLowerCase()}`);if(!m.ok)throw new Error("Pokemon not found");const f=await m.json();return{id:f.id,name:f.name,image:f.sprites.front_shiny||f.sprites.front_default,types:f.types.map(p=>p.type.name),stats:f.stats.slice(0,4).map(p=>({name:p.stat.name,base:p.base_stat}))}}const[a,u]=i.useState(""),[o,l]=i.useState(null),[d,s]=i.useState(!1),r=async n=>{if(n.preventDefault(),s(!1),l(null),!!a)try{const m=await c(a);console.log(m),l(m),s(!1)}catch(m){console.error("Single Pokemon search error:",m),s(!0)}},t=()=>{u(""),s(!1),l(null)};return e.jsxs("div",{className:"flex flex-col mb-10 ",children:[e.jsxs("form",{onSubmit:r,className:"flex flex-col md:flex-row text-center mb-4",children:[e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",placeholder:"Type Name or Number",value:a,onChange:n=>u(n.target.value),className:" grow border -mr-10 py-3 px-5 rounded-l-xl border-gray-700 focus:outline-none focus:border-yellow-500 bg-gray-800 text-gray-200"}),e.jsx("button",{type:"submit",className:"w-fit bg-blue-heart text-slate-900 px-4 rounded-r-xl font-semibold flex-none",disabled:!a,children:"Search"})]}),a&&e.jsx("button",{type:"button",onClick:t,className:"w-fit mt-4 md:mt-0 ml-2 px-6 py-2 bg-gray-800 rounded-xl text-gray-300 font-semibold flex-none self-center md:self-auto",children:"Clear"})]}),o&&e.jsxs("div",{className:"w-full",children:[e.jsx(x,{id:o.id,name:o.name,image:o.image,types:o.types,stats:o.stats},o.id),e.jsx("hr",{className:" rounded border-gray-700 my-4"})]}),d&&a&&e.jsxs("div",{children:[e.jsx("p",{className:"w-full text-center my-6",children:"Pokemon not founded ðŸ˜ž"}),e.jsx("hr",{className:" rounded border-gray-700 my-4"})]})]})}function k(){const[c,a]=i.useState([]),[u,o]=i.useState(0),[l,d]=i.useState(!1),s=i.useRef(null),r=async()=>{if(!l){d(!0);try{const t=await g(u,20);a(n=>[...n,...t]),o(n=>n+20)}catch(t){console.error(t)}finally{d(!1)}}};return i.useEffect(()=>{r()},[]),i.useEffect(()=>{if(c.length===0)return;const t=new IntersectionObserver(n=>{n[0].isIntersecting&&!l&&r()},{rootMargin:"-30px"});return s.current&&t.observe(s.current),()=>{s.current&&t.unobserve(s.current)}},[c,l]),e.jsxs("div",{className:" w-screen px-4 py-6",children:[e.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/4 mx-auto",children:e.jsx(w,{})}),e.jsx("h1",{className:"capitalize text-center font-bold text-xl my-4 text-yellow-600/90",children:"All pokemons"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:c.map(t=>e.jsx(x,{id:t.id,name:t.name,image:t.image,types:t.types,stats:t.stats},t.id))}),e.jsx("div",{ref:s,className:"py-4"}),l&&e.jsx("p",{className:"text-center text-yellow-400 font-bold mt-4 text-lg",children:"Loading Pokemons..."}),e.jsx(h,{})]})}export{k as default};
