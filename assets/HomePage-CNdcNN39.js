import{r as i,j as t}from"./index-CUznpdhE.js";import{P as x}from"./PokemonCard-Cdhv_yq7.js";const h=20;async function g(c=0){const a=await fetch(`https://pokeapi.co/api/v2/pokemon?offset=${c}&limit=${h}`);if(!a.ok)throw new Error("Failed to fetch Pokemon list");const n=(await a.json()).results.map(async d=>{const s=await fetch(`${d.url}`);if(!s.ok)throw new Error("Failed to fetch pokemon detail");const o=await s.json();return{id:o.id,name:o.name,image:o.sprites.front_shiny||o.sprites.front_default||"",types:o.types.map(e=>e.type.name),stats:o.stats.slice(0,4).map(e=>({name:e.stat.name,base:e.base_stat}))}});return await Promise.all(n)}function y(){async function c(r){const m=await fetch(`https://pokeapi.co/api/v2/pokemon/${r.toLowerCase()}`);if(!m.ok)throw new Error("Pokemon not found");const f=await m.json();return{id:f.id,name:f.name,image:f.sprites.front_shiny||f.sprites.front_default,types:f.types.map(p=>p.type.name),stats:f.stats.slice(0,4).map(p=>({name:p.stat.name,base:p.base_stat}))}}const[a,u]=i.useState(""),[n,l]=i.useState(null),[d,s]=i.useState(!1),o=async r=>{if(r.preventDefault(),s(!1),l(null),!!a)try{const m=await c(a);console.log(m),l(m),s(!1)}catch(m){console.error("Single Pokemon search error:",m),s(!0)}},e=()=>{u(""),s(!1),l(null)};return t.jsxs("div",{className:"flex flex-col mb-4 ",children:[t.jsxs("form",{onSubmit:o,className:"flex flex-col md:flex-row text-center mb-4",children:[t.jsxs("div",{className:"flex",children:[t.jsx("input",{type:"text",placeholder:"Name or Number",value:a,onChange:r=>u(r.target.value),className:" grow border -mr-10 py-3 px-5 rounded-l-xl border-gray-700 focus:outline-none focus:border-yellow-500 bg-gray-800 text-gray-200"}),t.jsx("button",{type:"submit",className:"w-fit bg-blue-heart text-slate-900 px-4 rounded-r-xl font-semibold flex-none",disabled:!a,children:"Search"})]}),a&&t.jsx("button",{type:"button",onClick:e,className:"w-fit mt-4 md:mt-0 ml-2 px-6 py-2 bg-gray-800 rounded-xl text-gray-300 font-semibold flex-none self-center md:self-auto",children:"Clear"})]}),n&&t.jsx("div",{className:"w-full",children:t.jsx(x,{id:n.id,name:n.name,image:n.image,types:n.types,stats:n.stats},n.id)}),d&&a&&t.jsx("p",{className:"w-full text-center my-6",children:"Pokemon not founded ðŸ˜ž"})]})}function j(){const[c,a]=i.useState([]),[u,n]=i.useState(0),[l,d]=i.useState(!1),s=i.useRef(null),o=async()=>{if(!l){d(!0);try{const e=await g(u,20);a(r=>[...r,...e]),n(r=>r+20)}catch(e){console.error(e)}finally{d(!1)}}};return i.useEffect(()=>{o()},[]),i.useEffect(()=>{if(c.length===0)return;const e=new IntersectionObserver(r=>{r[0].isIntersecting&&!l&&o()},{rootMargin:"-30px"});return s.current&&e.observe(s.current),()=>{s.current&&e.unobserve(s.current)}},[c,l]),t.jsxs("div",{className:" w-screen px-4 py-6",children:[t.jsx("div",{className:"w-full sm:w-1/2 md:w-1/3 lg:w-1/4 mx-auto",children:t.jsx(y,{})}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:c.map(e=>t.jsx(x,{id:e.id,name:e.name,image:e.image,types:e.types,stats:e.stats},e.id))}),t.jsx("div",{ref:s,className:"py-4"}),l&&t.jsx("p",{className:"text-center text-yellow-400 font-bold mt-4 text-lg",children:"Loading Pokemons..."})]})}export{j as default};
